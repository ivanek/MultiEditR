% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{pvalue_adjust}
\alias{pvalue_adjust}
\title{Calculate and Adjust P-values for Base Editor Off-Target Sites}
\usage{
pvalue_adjust(
  sanger_df,
  wt,
  boi,
  motif,
  sample_file,
  critical_values,
  zaga_parameters,
  p_value
)
}
\arguments{
\item{sanger_df}{A \code{tibble} containing sanger sequencing
data, including base call areas (\code{A_area} to \code{T_area}),
percentages (\code{A_perc} to \code{T_perc}), and control base
information (\code{ctrl_max_base}).}

\item{wt}{A \code{character} string representing the wild-type
base or bases (e.g., 'C' or 'GA') to filter for.}

\item{boi}{A \code{character} string listing the base(s) of
interest (e.g., 'G' for a C-to-T editor acting on the opposite
strand, looking for G to A).}

\item{motif}{A \code{character} string identifying the editing
motif used, added as a final column.}

\item{sample_file}{A \code{character} string identifying the
sample file name, added as a final column.}

\item{critical_values}{A \code{tibble} of critical values
(though not used in the current function logic, it is
retained for compatibility).}

\item{zaga_parameters}{A \code{tibble} of fitted ZAGA
distribution parameters (\eqn{\mu}, \eqn{\sigma}, \eqn{\nu}, 
\code{crit}) for each base, generated by \code{make_ZAGA_df}.}

\item{p_value}{A \code{numeric} significance cutoff (e.g., 0.05)
to determine significance after p-value adjustment.}
}
\value{
A \code{tibble} filtered and augmented with raw
  p-values (\code{A_pvalue} to \code{T_pvalue}), BH-adjusted
  p-values (\code{A_p_adjust} to \code{T_p_adjust}), and
  columns indicating significance both raw (\code{A_sig} to
  \code{T_sig}) and adjusted (\code{A_sig_adjust} to
  \code{T_sig_adjust}).
}
\description{
Filters the sanger \code{tibble} for bases of interest (BOI),
calculates the p-value for each base's area using the fitted
Zero-Adjusted Gamma (ZAGA) distribution (representing noise),
applies Benjamini-Hochberg (BH) correction, and determines
statistical significance based on a defined cutoff.
}
\examples{
# The ZAGA parameters must be calculated first:
# zaga_params <- make_ZAGA_df(sanger_data, p_adjust = 0.05)
# adjusted_df <- pvalue_adjust(sanger_data, wt = "C",
#   boi = "T", motif = "ACC", sample_file = "sample1.ab1",
#   critical_values = tibble(), zaga_parameters = zaga_params,
#   p_value = 0.05)
}
\keyword{internal}
