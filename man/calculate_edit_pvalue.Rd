% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{calculate_edit_pvalue}
\alias{calculate_edit_pvalue}
\title{Calculate P-values and Significance for a Specific Base Edit}
\usage{
calculate_edit_pvalue(motif_part_of_sample, zaga_parameters, wt, edit, p_value)
}
\arguments{
\item{motif_part_of_sample}{A \code{data.frame} containing sanger
sequencing data, including base call areas (e.g., \code{T_area})
and an \code{expected_motif} column.}

\item{zaga_parameters}{A \code{data.frame} of fitted ZAGA
distribution parameters (\eqn{\mu}, \eqn{\sigma}, \eqn{\nu}, 
\code{crit}) for each base, generated by \code{make_ZAGA_df}.}

\item{wt}{A \code{character} string specifying the wild-type base
(e.g., "C") being targeted by the editor.}

\item{edit}{A \code{character} string specifying the expected
edited base (e.g., "T" for a C-to-T editor).}

\item{p_value}{A \code{numeric} significance cutoff (e.g., 0.05)
for the adjusted p-value.}
}
\value{
The original \code{motif_part_of_sample} data frame
  augmented with three new columns for the rows where
  \code{expected_motif} equals \code{wt}: \code{edit_pvalue} (raw),
  \code{edit_padjust} (BH-adjusted), and \code{edit_sig} (logical
  significance based on \code{edit_padjust < p_value}). Other
  rows will have \code{NA} in these new columns.
}
\description{
Calculates the p-value for the area of a potential edited base
(e.g., T for C-to-T edit) using the Zero-Adjusted Gamma (ZAGA)
noise model, applies Benjamini-Hochberg (BH) correction, and
determines statistical significance. This function focuses only
on the wild-type bases that are susceptible to editing.
}
\examples{
# zaga_params must be calculated first:
# zaga_params <- make_ZAGA_df(sanger_data, p_adjust = 0.05)
# edited_df <- calculate_edit_pvalue(sample_df, zaga_params,
#   wt = "C", edit = "T", p_value = 0.05)
}
